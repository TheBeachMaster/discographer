disk_configure_functions=()

function disk_configure_defaultConfiguration()
{
	configuration_sourceDefaultConfiguration "disk"
}
disk_configure_functions+=(disk_configure_defaultConfiguration)

function disk_configure_sourceConfiguration()
{
	source "$configMachineDisksPath"/"$disk".disk
}
disk_configure_functions+=(disk_configure_sourceConfiguration)

function disk_configure_verifyConfiguration()
{
	if [ ${#machineDiskVolumeLabel16Bytes} -gt 16 ]; then
		informationMessage FAIL "Machine $machine has a disk $disk with a label greater than 16 characters (defaults to disk name) in parameters or disk folder"
		exit 1
	fi
	
	case "$machineDiskFilesystemType" in
		
		ext[2-4])
			:
		;;
		
		btrfs)
			:
		;;
		
		xfs)
			:
		;;
		
		swap)
			:
		;;
		
		*)
			informationMessage FAIL "Machine $machine has a disk $disk with an unknown filesystem type $machineDiskFilesystemType"
			exit 1
		;;
	
	esac
}
disk_configure_functions+=(disk_configure_verifyConfiguration)

function disk_configure_captureInABashDictionaryConfiguration()
{
	machine_disksConfigurationSize["$disk"]="$machineDiskSize"
	machine_disksConfigurationMountPoint["$disk"]="$machineDiskMountPoint"
	machine_disksConfigurationFilesystemType["$disk"]="$machineDiskFilesystemType"
	machine_disksConfigurationBlockSize["$disk"]="$machineDiskBlockSize"
	machine_disksConfigurationDiskImagePath["$disk"]="$cacheMachineDisksPath"/"$disk".img
	machine_disksConfigurationImageMountPath["$disk"]="${cacheMachineDisksMountsPath}${machineDiskMountPoint}"
	machine_disksConfigurationVolumeLabel16Bytes["$disk"]="$machineDiskVolumeLabel16Bytes"
	machine_disksConfigurationUuid["$disk"]="$machineDiskUuid"
	machine_disksConfigurationOptions["$disk"]="$machineDiskOptions"
	machine_disksConfigurationMountOptions["$disk"]="$machineDiskMountOptions"
	machine_disksConfigurationDumpOptions["$disk"]="$machineDiskDumpOptions"
	machine_disksConfigurationFsckOptions["$disk"]="$machineDiskFsckOptions"
	machine_disksConfigurationShrinkDisk["$disk"]="$machineDiskShrink"
	machine_disksConfigurationBootable["$disk"]="$machineDiskBootable"
	machine_disksConfigurationPartitionImagePath["$disk"]=""
}
disk_configure_functions+=(disk_configure_captureInABashDictionaryConfiguration)
